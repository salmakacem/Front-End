if (self.CavalryLogger) { CavalryLogger.start_js_script(document.currentScript); }/*FB_PKG_DELIM*/

__d("LSFetchBackupIds",["LSAppendDataTraceAddon","LSCreateDataTraceID.bs","LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(e){return c.seq([function(e){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsFetchBackupIdsStoredProcedure]Beginning execution."),c.seq([function(e){return a[1]!==f?c.resolve(d[0]=a[1]):c.seq([function(a){return c.islc(c.ftr(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,[0,80])&&c.i64.eq(a.backupTenancy,[0,2])}),0,c.i64.to_float([0,1])).next().then(function(a,b){b=a.done;a=a.value;return b?d[3]=!1:(a.item,d[3]=!0)})},function(a){return d[3]?d[5]=c.i64.or_([0,69],[0,128]):d[5]=[0,69],c.nop(b("LSCreateDataTraceID.bs")).then(function(a){return a=a,d[6]=a[0],a})},function(a){return d[7]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][MEBTraceUtils]",d[7],"EncryptedBackups Trace ID",d[7],c.i64.to_string(d[5])].join("")),c.db.table(153).add({traceId:d[6],initTimestampMs:c.i64.of_float(Date.now()),traceType:d[5],shouldFlush:!1,contextThree:"fetch_backup_status"})},function(a){return d[0]=d[6]}])},function(a){return d[0]!==f?c.sp(b("LSAppendDataTraceAddon"),d[0],[0,1468],[0,2],f,f):c.resolve()},function(a){return c.fe(c.db.table(172).fetch(),function(a){return a["delete"]()})},function(a){return c.fe(c.ftr(c.db.table(172).fetch([[[[0,1]]]]),function(a){return c.i64.eq(a.pk,[0,1])&&c.i64.lt(a.authorityLevel,[0,20])}),function(a){return a["delete"]()})},function(b){return c.db.table(172).add({pk:[0,1],authorityLevel:[0,20],backupTenancy:a[0]})},function(e){return d[1]=new c.Map(),d[1].set("backup_tenancy",a[0]),d[1].set("trace_id",d[0]),d[2]=c.toJSON(d[1]),c.sp(b("LSIssueNewTask"),"encrypted_backups_setup",[0,50008],d[2],f,f,[0,0],[0,0],f,f,[0,0])}])},function(a){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsFetchBackupIdsStoredProcedure]Finishing execution.")}])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSEncryptedBackupsBackupTenancy.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").one;c=[0,2];f.production=a;f.shadow=c}),null);
__d("MWEncryptedBackupsFetchBackupIds.bs",["LS.bs","LSEncryptedBackupsBackupTenancy.bs","LSFetchBackupIds","LSTransaction.bs","react","useReStore"],(function(a,b,c,d,e,f){"use strict";var g,h=g||b("react");function a(a){var c=b("useReStore")();return h.useCallback(function(a){return b("LSTransaction.bs").run(c,function(a){return b("LSFetchBackupIds")(b("LSEncryptedBackupsBackupTenancy.bs").production,void 0,b("LS.bs").make(a))},"readWrite")},[c])}f.useHook=a}),null);
__d("MWEncryptedBackupsListenForChangesToBackupState.bs",["MWEncryptedBackupsFetchBackupIds.bs","ReQL.bs","ReQLSubscription.bs","bs_curry","promiseDone","react","useReStore"],(function(a,b,c,d,e,f){"use strict";var g,h=g||b("react");function a(a){var c=b("useReStore")(),d=b("MWEncryptedBackupsFetchBackupIds.bs").useHook(void 0),e=h.useRef(!1),f={contents:function(a){}};h.useEffect(function(){if(!e.current){e.current=!0;var a=b("ReQL.bs").fromTableAscending(c.table("encrypted_backups_status_trigger"));f.contents=b("ReQLSubscription.bs").subscribe(c,a,function(a){b("promiseDone")(b("bs_curry")._1(d,void 0),void 0,void 0)})}},[]);return function(a){return b("bs_curry")._1(f.contents,void 0)}}f.useHook=a}),null);
__d("MWEncryptedBackupsListenForChangesToBackupState.re",["MWEncryptedBackupsListenForChangesToBackupState.bs"],(function(a,b,c,d,e,f){a=b("MWEncryptedBackupsListenForChangesToBackupState.bs").useHook;f.useHook=a}),null);